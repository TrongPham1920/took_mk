<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <title>Tool G·ªôp B√°o C√°o TikTok Shop - Sim H·∫£i ƒêƒÉng</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #f0f2f5;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
    }

    .box {
      background: #fff;
      padding: 30px;
      width: 100%;
      max-width: 450px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
    }

    h2 {
      text-align: center;
      margin-bottom: 10px;
      color: #1e293b;
      font-size: 22px;
    }

    .subtitle {
      text-align: center;
      color: #64748b;
      font-size: 14px;
      margin-bottom: 25px;
    }

    .input-group {
      margin-bottom: 20px;
    }

    .input-group label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #475569;
    }

    .label-desc {
      display: block;
      font-size: 11px;
      font-weight: normal;
      color: #94a3b8;
      margin-top: 2px;
    }

    input[type="file"] {
      width: 100%;
      padding: 8px;
      border: 1px dashed #cbd5e1;
      border-radius: 6px;
      background: #f8fafc;
      cursor: pointer;
      box-sizing: border-box;
    }

    input[type="file"]:hover {
      border-color: #2563eb;
    }

    .note-box {
      background: #fff7ed;
      border-left: 4px solid #f97316;
      padding: 12px;
      margin-bottom: 20px;
      border-radius: 4px;
    }

    .note-box ul {
      margin: 0;
      padding-left: 20px;
      font-size: 12px;
      color: #9a3412;
      line-height: 1.6;
    }

    button {
      width: 100%;
      padding: 14px;
      background: #2563eb;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }

    button:hover {
      background: #1d4ed8;
    }

    button:disabled {
      background: #94a3b8;
      cursor: not-allowed;
    }

    .status {
      margin-top: 15px;
      font-size: 14px;
      text-align: center;
      min-height: 20px;
    }

    .success {
      color: #10b981;
      font-weight: bold;
    }

    .error {
      color: #ef4444;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <div class="box">
    <h2>üìä G·ªôp B√°o C√°o ƒê·ªëi So√°t</h2>
    <p class="subtitle">Phi√™n b·∫£n Desktop - Sim H·∫£i ƒêƒÉng</p>

    <div class="note-box">
      <ul>
        <li><b>File 1:</b> File T·ªîNG ƒê∆†N (G·ªëc)</li>
        <li><b>File 2:</b> File DOANH THU (G·ªëc)</li>
        <li><i>L∆∞u √Ω: Ch·ªâ gi·ªØ l·∫°i c√°c g√≥i SIM theo danh m·ª•c.</i></li>
      </ul>
    </div>

    <div class="input-group">
      <label for="file1">üìÅ 1. Ch·ªçn File T·ªîNG ƒê∆†N</label>
      <input type="file" id="file1" accept=".xlsx,.xls" />
    </div>

    <div class="input-group">
      <label for="file2">üìÅ 2. Ch·ªçn File DOANH THU</label>
      <input type="file" id="file2" accept=".xlsx,.xls" />
    </div>

    <button id="btnSubmit" onclick="mergeFiles()">‚ö° B·∫Øt ƒë·∫ßu g·ªôp & L∆∞u file</button>

    <div class="status" id="status"></div>
  </div>

  <script>

    const { ipcRenderer } = require('electron');

    async function mergeFiles() {
      const file1Input = document.getElementById("file1");
      const file2Input = document.getElementById("file2");
      const status = document.getElementById("status");
      const button = document.getElementById("btnSubmit");


      if (!file1Input.files.length || !file2Input.files.length) {
        alert("Vui l√≤ng ch·ªçn ƒë·ªß c·∫£ 2 file!");
        return;
      }

      const file1Path = file1Input.files[0].path;
      const file2Path = file2Input.files[0].path;

      status.className = "status";
      status.innerText = "‚è≥ ƒêang g·ªôp d·ªØ li·ªáu... Vui l√≤ng ƒë·ª£i trong gi√¢y l√°t.";
      button.disabled = true;

      try {

        const response = await ipcRenderer.invoke('process-excel', {
          file1Path: file1Path,
          file2Path: file2Path
        });

        if (response.success) {
          status.innerHTML = `<span class='success'>‚úÖ ${response.message}</span>`;
        } else {
          throw new Error(response.message);
        }

      } catch (err) {
        console.error(err);
        status.innerHTML = `<span class='error'>‚ùå L·ªói: ${err.message}</span>`;
      } finally {
        button.disabled = false;
      }
    }
  </script>
</body>

</html>